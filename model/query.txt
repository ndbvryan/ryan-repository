CREATE DATABASE QLPK CHARACTER SET utf8 COLLATE utf8_general_ci;

USE QLPK;

CREATE TABLE BacSi ( 
	idUser INT NOT NULL AUTO_INCREMENT, 
	username VARCHAR(30)NOT NULL UNIQUE,
	password VARCHAR(30)NOT NULL,
	ten_BS VARCHAR(30) NOT NULL,
	PRIMARY KEY(idUser)
);
CREATE  TABLE Thuoc (
	idThuoc INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ten_thuoc VARCHAR(100) NOT NULL,
	dvt VARCHAR(50) NOT NULL,
	so_luong INT NOT NULL,
	gia_mua DOUBLE NOT NULL,
	gia_ban DOUBLE NOT NULL,
	han_sd VARCHAR(20) NOT NULL				
);
CREATE  TABLE BenhNhan (
	idBN INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ten VARCHAR(100) NOT NULL,
	nam_sinh INT UNSIGNED NOT NULL,
	address VARCHAR(200),
	phone_num VARCHAR(50) NOT NULL
);
CREATE  TABLE PhieuKham (
	idPhieuKham INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ten_BS VARCHAR(100) NOT NULL,
    chan_doan VARCHAR(300) NOT NULL,
    idBN INT UNSIGNED,
    FOREIGN KEY (idBN) REFERENCES BenhNhan(idBN)
);
CREATE  TABLE ToaThuoc (
	idToaThuoc INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ngay_lap datetime NOT NULL,
	so_ngay INT NOT NULL,
	loi_dan VARCHAR(300) NOT NULL,
	tong_tien DOUBLE NOT NULL,
    idPhieuKham INT UNSIGNED,
	FOREIGN KEY (idPhieuKham) REFERENCES PhieuKham(idPhieuKham)				
);
CREATE  TABLE ChiTietThuoc (
	idCT_thuoc INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
	so_vien INT NOT NULL,
	duong_dung VARCHAR(100) NOT NULL,
	quy_cach VARCHAR(150),
	idToaThuoc INT UNSIGNED NOT NULL,
	idThuoc INT UNSIGNED NOT NULL,
	FOREIGN KEY (idToaThuoc) REFERENCES ToaThuoc(idToaThuoc),
	FOREIGN KEY (idThuoc) REFERENCES Thuoc(idThuoc)				
);
